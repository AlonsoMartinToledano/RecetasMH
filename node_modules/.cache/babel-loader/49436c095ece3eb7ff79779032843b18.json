{"ast":null,"code":"var _jsxFileName = \"/home/alonso/GitHub/RecetasMH/src/components/UploadFile.jsx\";\nimport React, { useState } from \"react\";\nimport { useMutation } from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\nimport { sessionState } from \"../recoil/atoms\";\nimport { useRecoilState } from \"recoil\";\nimport styled from \"styled-components\";\nimport { OK, Error, Title } from \"../style/styles\";\nconst UPLOAD_FILE = gql`\n  mutation uploadFile($userid: ID!, $token: String!, $upload: Upload!) {\n    uploadFile(userid: $userid, token: $token, upload: $upload) {\n      url\n      mimetype\n      encoding\n    }\n  }\n`;\nexport default (props => {\n  const [session] = useRecoilState(sessionState);\n  const {\n    stepImage\n  } = props;\n  let {\n    mainImage\n  } = props;\n  const [uploadFileMutation, {\n    loading,\n    error,\n    data\n  }] = useMutation(UPLOAD_FILE, {\n    onError(error) {\n      console.log(error);\n    }\n\n  });\n\n  const uploadFile = ({\n    target: {\n      validity,\n      files: [file]\n    }\n  }) => {\n    if (validity.valid) {\n      uploadFileMutation({\n        variables: {\n          userid: session.userid,\n          token: session.token,\n          upload: file\n        }\n      });\n    }\n  };\n\n  if (loading) return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 23\n    }\n  }, \"Loading...\");\n\n  if (error) {\n    if (error.message.includes(\"Cast to ObjectId\")) {\n      return /*#__PURE__*/React.createElement(Error, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 14\n        }\n      }, \"El usuario no ha iniciado sesi\\xF3n correctamente\");\n    } else {\n      return /*#__PURE__*/React.createElement(Error, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 14\n        }\n      }, \"Ha ocurrido un error inesperado, vuelve a intentarlo m\\xE1s tarde\");\n    }\n  }\n\n  if (data) {\n    const url = `http://77.228.91.193/${data.uploadFile.url}`;\n\n    if (stepImage) {\n      stepImage.url = data.uploadFile.url;\n      stepImage.mimetype = data.uploadFile.mimetype;\n      stepImage.encoding = data.uploadFile.encoding;\n    } else {\n      mainImage = {\n        url: data.uploadFile.url,\n        mimetype: data.uploadFile.mimetype,\n        encoding: data.uploadFile.encoding\n      };\n    }\n\n    return /*#__PURE__*/React.createElement(UploadFile, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(OK, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 7\n      }\n    }, \"Archivo subido correctamente\"), /*#__PURE__*/React.createElement(Image, {\n      src: url,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 7\n      }\n    }));\n  }\n\n  return /*#__PURE__*/React.createElement(UploadFile, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }\n  }, \"Subir Archivo\"), /*#__PURE__*/React.createElement(Input, {\n    type: \"file\",\n    name: \"file\",\n    id: \"file\",\n    required: true,\n    onChange: uploadFile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Label, {\n    for: \"file\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }\n  }, \"Escoge un archivo\"));\n});\nconst UploadFile = styled.div`\n  padding: 20px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n`;\nconst Image = styled.img`\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  padding: 5px;\n  width: 200px;\n`;\nconst Input = styled.input`\n  width: 0.1px;\n\theight: 0.1px;\n\topacity: 0;\n\toverflow: hidden;\n\tposition: absolute;\n\tz-index: -1;\n`;\nconst Label = styled.label`\n  font-size: 1em;\n  width: 200px;\n  padding: 5px;\n  border: black solid 1px;\n  color: black;\n  background-color: aquamarine;\n  display: inline-block;\n  &:hover{\n    background-color: #aaaaaa;\n    cursor: pointer\n  }\n`;","map":{"version":3,"sources":["/home/alonso/GitHub/RecetasMH/src/components/UploadFile.jsx"],"names":["React","useState","useMutation","gql","sessionState","useRecoilState","styled","OK","Error","Title","UPLOAD_FILE","props","session","stepImage","mainImage","uploadFileMutation","loading","error","data","onError","console","log","uploadFile","target","validity","files","file","valid","variables","userid","token","upload","message","includes","url","mimetype","encoding","UploadFile","div","Image","img","Input","input","Label","label"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { useMutation } from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\nimport { sessionState } from \"../recoil/atoms\";\nimport { useRecoilState } from \"recoil\";\nimport styled from \"styled-components\";\nimport { OK, Error, Title } from \"../style/styles\";\n\nconst UPLOAD_FILE = gql`\n  mutation uploadFile($userid: ID!, $token: String!, $upload: Upload!) {\n    uploadFile(userid: $userid, token: $token, upload: $upload) {\n      url\n      mimetype\n      encoding\n    }\n  }\n`;\n\nexport default props => {\n  const [session] = useRecoilState(sessionState);\n\n  const {stepImage} = props;\n  let {mainImage} = props;\n\n  const [uploadFileMutation, { loading, error, data }] = useMutation(\n    UPLOAD_FILE,\n    {\n      onError(error) {\n        console.log(error);\n      },\n    },\n  );\n\n  const uploadFile = ({\n    target: {\n      validity,\n      files: [file],\n    },\n  }) => {\n    if (validity.valid) {\n      uploadFileMutation({\n        variables: {\n          userid: session.userid,\n          token: session.token,\n          upload: file,\n        },\n      });\n    }\n  };\n\n  if (loading) return <div>Loading...</div>;\n  if (error) {\n    if (error.message.includes(\"Cast to ObjectId\")) {\n      return <Error>El usuario no ha iniciado sesión correctamente</Error>;\n    } else {\n      return <Error>\n        Ha ocurrido un error inesperado, vuelve a intentarlo más tarde\n      </Error>;\n    }\n  }\n\n  if (data) {\n    const url = `http://77.228.91.193/${data.uploadFile.url}`;\n\n    if (stepImage) {\n      stepImage.url = data.uploadFile.url;\n      stepImage.mimetype = data.uploadFile.mimetype;\n      stepImage.encoding = data.uploadFile.encoding;\n    } else {\n      mainImage = {\n        url: data.uploadFile.url,\n        mimetype: data.uploadFile.mimetype,\n        encoding: data.uploadFile.encoding\n      }\n    }\n\n    return (<UploadFile>\n      <OK>Archivo subido correctamente</OK>\n      <Image src={url} />\n    </UploadFile>);\n  }\n\n  return (\n    <UploadFile>\n      <Title>Subir Archivo</Title>\n\n      <Input\n        type=\"file\"\n        name=\"file\"\n        id=\"file\"\n        required\n        onChange={uploadFile}\n      />\n      <Label for=\"file\">Escoge un archivo</Label>\n    </UploadFile>\n  );\n};\n\nconst UploadFile = styled.div`\n  padding: 20px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst Image = styled.img`\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  padding: 5px;\n  width: 200px;\n`;\n\nconst Input = styled.input`\n  width: 0.1px;\n\theight: 0.1px;\n\topacity: 0;\n\toverflow: hidden;\n\tposition: absolute;\n\tz-index: -1;\n`;\n\nconst Label = styled.label`\n  font-size: 1em;\n  width: 200px;\n  padding: 5px;\n  border: black solid 1px;\n  color: black;\n  background-color: aquamarine;\n  display: inline-block;\n  &:hover{\n    background-color: #aaaaaa;\n    cursor: pointer\n  }\n`;\n"]},"metadata":{},"sourceType":"module"}